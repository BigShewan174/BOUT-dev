#grid = "21712_grid.nc"
grid = "21712_v4.2.grd.nc"

non_uniform = false

[mesh]
nx = 32
ny = 16
nz = 32
g22 = .9
g_11 = 1.
g_22 = .9
g_33 = 1.
g_12 = 0.
g_13 = 0.
g_23 = 0.

#############################################

[laplace]
type=petsc3damg
include_yguards=false
all_terms=true
rtol=1.e-6
## Note, set a fairly high atol here because the RHS in this test is large, O(10^6)
atol=1.e-10
dtol=1.e12
maxits=1000

#############################################
# input variables for tests
#############################################

[f1]
# zero value x boundary conditions
p = 0.39503274
#q = 0.9103870869077473
r = 0.20974396
function = sin(2*pi*3*x)*sin(y)*cos(z-p) + sin(2*pi*x)*sin(2*y)*cos(3*z-r)
[d1]
p = 0.512547
q = 0.4267958281955716
r = 0.30908712
function = 1. + .1*cos(4.*x-p)*cos(3*y-q)*sin(3*z-r)
[c1]
p = 0.18439023
q = 0.5063336314573927
r = 0.401089473
function = 1. + .1*sin(3.2*x-p)*sin(2*y-q)*sin(2*z-r)
[a1]
p = 0.612547
q = 0.8793233964876623
r = 0.30908712
function = -1. + .1*sin(1.43*x-p)*cos(y-q)*sin(5*z-r)
[f2]
# zero gradient x boundary conditions
p = 0.39503274
#q = 0.24564547309449003
r = 0.20974396
function = cos(2*pi*3*x)*sin(3*y)*cos(z-p) + cos(2*pi*x)*sin(y)*cos(3*z-r)
[d2]
p = 0.512547
q = 0.48247367632708915
r = 0.30908712
function = 1. + .1*cos(4.*x-p)*sin(2*y-q)*sin(3*z-r)
[c2]
p = 0.18439023
q = 0.05738942828403448
r = 0.401089473
function = 1. + .1*sin(3.2*x-p)*sin(5*y-q)*sin(2*z-r)
[a2]
p = 0.612547
q = 0.960661514455672
r = 0.30908712
function = -1. + .1*sin(1.43*x-p)*sin(y-q)*sin(5*z-r)
[f3]
# set value x boundary conditions
p = 0.39503274
#q = 0.276882605282872
r = 0.20974396
function = sin(2*pi*3*x-r)*sin(y)*cos(z-p) + sin(2*pi*x-p)*sin(3*y)*cos(3*z-r)
[d3]
p = 0.512547
q = 0.9568116121149045
r = 0.30908712
function = 1. + .1*cos(4.*x-p)*sin(y-q)*sin(3*z-r)
[c3]
p = 0.18439023
q = 0.663762222188715
r = 0.401089473
function = 1. + .1*sin(3.2*x-p)*sin(2*y-q)*sin(2*z-r)
[a3]
p = 0.612547
q = 0.47635163187026497
r = 0.30908712
function = -1. + .1*sin(1.43*x-p)*sin(2*y-q)*sin(5*z-r)
[f4]
# set gradient x boundary conditions
p = 0.39503274
#q = 0.361349578323241
r = 0.20974396
function = sin(2*pi*3*x+r)*sin(y)*cos(z-p) + sin(2*pi*x+p)*sin(5*y)*cos(3*z-r)
[d4]
p = 0.512547
q = 0.6981594646248526
r = 0.30908712
function = 1. + .1*cos(4.*x-p)*sin(3*y-q)*sin(3*z-r)
[c4]
p = 0.18439023
q = 0.6090492977181309
r = 0.401089473
function = 1. + .1*sin(3.2*x-p)*sin(2*y-q)*sin(2*z-r)
[a4]
p = 0.612547
q = 0.8778887150055424
r = 0.30908712
function = -1. + .1*sin(1.43*x-p)*sin(y-q)*sin(5*z-r)

[mesh:ddx]
first = c2
second = c2

[mesh:ddy]
first = c2
second = c2

[mesh:ddz]
first = c2
second = c2
